<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="/public/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/public/js/jquery-ui-1.8.2.custom.min.js"></script>   
<link type="text/css" rel="stylesheet" href="public/css/ui-lightness/jquery-ui-1.8.2.custom.css" media="all"/>


<script type="text/javascript">
	$(document).ready(function () {
		var myOptions = {
			zoom: 17,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		}
		var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions)

		if(navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(
				function(position) {
					map.setCenter(new google.maps.LatLng(position.coords.latitude,position.coords.longitude))
				},
				function() {})
		} else {
			map.setCenter(new google.maps.LatLng(-34.397, 150.644))
		}

		google.maps.event.addListener(map, 'click', function(event) {
			$("#create_form").dialog({
				autoOpen: true,
				height: 300,
				width: 350,
				modal: true,
				buttons: {
					Add: function() {
						var marker = new google.maps.Marker({
							position: event.latLng, 
							map: map,
							title: $("#name").val() 
						})

						var infowindow = new google.maps.InfoWindow({
						    content: $("#name").val() 
						})

						infowindow.open(map, marker)

						$(this).dialog('close')
					},
					Cancel: function() {
						$(this).dialog('close')
					}
				},
				close: function() {
				}
			})
		})
	})
</script>
</head>
<body>
	<div id="map_canvas" style="width:100%; height:100%"></div>


	<div id="create_form" title="add a hotspot" style="display:none">
		<form>
		<fieldset>
			<label for="name">Name</label>
			<input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all"/>
		</fieldset>
		</form>
	</div>
</body>
</html>
